# FacialVision
 

# Face Detection and Recognition with OpenCV

This repository demonstrates the implementation of facial detection and recognition using OpenCV. The project is divided into two parts:
1. **Face Detection**: Detecting faces in images using Haar Cascades.
2. **Face Recognition**: Recognizing faces using Local Binary Patterns Histograms (LBPH) with OpenCV.

## Prerequisites

- Python 3.x
- OpenCV (with Contrib modules)
- NumPy

You can install the necessary packages using:
```bash
pip install opencv-contrib-python numpy
```

## Directory Structure

```
face_recognition/
│
├── face_recog.py             # Script for face recognition
├── faces_train.py            # Script for training the face recognizer
├── haar_face.xml             # Haar Cascade for face detection
├── features.npy              # Numpy array of face features (generated by training script)
├── labels.npy                # Numpy array of labels (generated by training script)
├── face_trained.yml          # Trained model file (generated by training script)
└── images/
    ├── person1/
    │   ├── img1.jpg
    │   ├── img2.jpg
    │   └── ...
    ├── person2/
    │   ├── img1.jpg
    │   ├── img2.jpg
    │   └── ...
    └── ...
```

## Face Detection

### face_recog.py

This script performs face detection and recognition on a given image.

```python
import os
import numpy as np
import cv2 as cv

haar_cascade = cv.CascadeClassifier('../haar_face.xml')

people = []
for person in os.listdir("/Users/kapardhikannekanti/images"):
    people.append(person)

if '.DS_Store' in people:
    people.remove('.DS_Store')

features = np.load('features.npy', allow_pickle=True)
labels = np.load('labels.npy', allow_pickle=True)

face_recognizer = cv.face.LBPHFaceRecognizer_create()
face_recognizer.read('face_trained.yml')

img_path = '/Users/kapardhikannekanti/images/kapardhi.jpeg'
print("Files in directory:", os.listdir("/Users/kapardhikannekanti/images"))
img = cv.imread(img_path)

if img is None:
    print(f"Error: Unable to read image at {img_path}")
else:
    gray = cv.cvtColor(img, cv.COLOR_BGR2GRAY)
    cv.imshow("Gray", gray)

    faces_rect = haar_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=4)

    for (x, y, w, h) in faces_rect:
        faces_roi = gray[y:y+h, x:x+w]
        
        label, confidence = face_recognizer.predict(faces_roi)
        print(f"Label = {people[label]} with confidence {confidence}")

        cv.putText(img, str(people[label]), (20, 20), cv.FONT_HERSHEY_COMPLEX, 1.0, color=(0, 255, 0), thickness=2)
        cv.rectangle(img, pt1=(x, y), pt2=(x+w, y+h), color=(0, 255, 0), thickness=2)

    cv.imshow("Detected Face", img)
    cv.waitKey(12000)
    cv.destroyAllWindows()
```

## Face Recognition Training

### faces_train.py

This script trains the face recognizer using images stored in the `images` directory.

```python
import os
import numpy as np
import cv2 as cv

# Load the Haar cascade classifier
haar_cascade = cv.CascadeClassifier('../haar_face.xml')

# Load people's names from the images directory
people = []
for person in os.listdir("/Users/kapardhikannekanti/images"):
    people.append(person)

# Remove any unwanted files like '.DS_Store' if present
if '.DS_Store' in people:
    people.remove('.DS_Store')

# Lists to hold features (face regions of interest) and labels
features = []
labels = []

# Function to create the training data
def create_train():
    for person in people:
        path = os.path.join("/Users/kapardhikannekanti/images", person)
        label = people.index(person)

        for img in os.listdir(path):
            img_path = os.path.join(path, img)

            img_array = cv.imread(img_path)
            gray = cv.cvtColor(img_array, cv.COLOR_BGR2GRAY)

            faces_rect = haar_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=4)

            for (x, y, w, h) in faces_rect:
                faces_roi = gray[y:y+h, x:x+w]
                features.append(faces_roi)
                labels.append(label)

create_train()

# Convert features and labels lists to numpy arrays
features = np.array(features, dtype='object')
labels = np.array(labels)

# Create an LBPH face recognizer
face_recognizer = cv.face.LBPHFaceRecognizer_create()

# Train the recognizer on the features (face images) and labels
face_recognizer.train(features, labels)

# Save the trained model
face_recognizer.save('face_trained.yml')

# Save the features and labels arrays for future use
np.save("features.npy", features)
np.save("labels.npy", labels)

print(f"Training done. Number of features: {len(features)}. Number of labels: {len(labels)}.")
```

## Notes on OpenCV's Built-in Face Recognizer

While OpenCV's built-in face recognizer (LBPH) is convenient and easy to use, it may not provide the highest accuracy for face recognition tasks, especially with larger and more diverse datasets. For more robust and accurate face recognition, consider using deep learning-based methods, such as those provided by libraries like Dlib or face_recognition, which leverage pre-trained models.

## Contributing

Contributions are welcome! Feel free to submit a pull request or open an issue if you have any suggestions or improvements.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Contact

For any inquiries or feedback, please contact Kapardhi Kannekanti at kapardhi.kannekanti@example.com.
```

This README file provides a clear overview of the project, instructions for setup and usage, and notes on the limitations of OpenCV's built-in face recognizer. Feel free to customize it further to better fit your project and preferences.